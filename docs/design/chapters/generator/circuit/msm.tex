\section{Multi-Scalar Multiplication Circuit}
\label{section:msm}

Input: $G_0, ..., G_{k - 1} \in \mathbb{G}, s_0, ..., s_{k - 1} \in \mathbb{F}_r$, where $\mathbb{F}_r$ is scalar field of $\mathbb{G}$.


Output: $S = \sum\limits_{i = 0}^{k}s_i \cdot G_i$

\paragraph{Using endomorphism:}

\begin{enumerate}
    \item $A = \infty$
    \item for $j$ from $0$ to $k-1$:
    \begin{enumerate}
        \item $r \coloneqq s_j$, $T \coloneqq G_j$
        \item $S = [2](\phi(T) + T)$
        \item for $i$ from $\frac{\lambda}{2} - 1$ to $0$:
        \begin{enumerate}
            \item $Q = r_{2i + 1} \: ? \: \phi([2r_{2i} - 1]T) : [2r_{2i} - 1]T$
            \item $R = S + Q$
            \item $S = R + S$
        \end{enumerate}
        \item $A = A + S$
    \end{enumerate}
\end{enumerate}

\begin{center}
    $\text{rows} \approx k \cdot (\texttt{sm\_rows} + 1 + 2) \approx 67k$,
\end{center}
where \texttt{sm\_rows} is the number of rows in the scalar multiplication circuit.

\paragraph{Without endomorphism:}

\begin{enumerate}
    \item $A = \infty$
    \item for $j$ from $0$ to $k-1$:
    \begin{enumerate}
        \item $r \coloneqq s_j$, $T \coloneqq G_j$
        \item $S = [2]T$
        \item for $i$ from $n - 1$ to $0$:
        \begin{enumerate}
            \item $Q = k_{i + 1} \: ? \: T : -T$
            \item $R = S + Q$
            \item $S = R + S$
        \end{enumerate}
        \item $A = A + S$
    \end{enumerate}
\end{enumerate}


\begin{center}
    $\text{rows} \approx k \cdot (\texttt{sm\_rows} + 1 + 1) \approx 105k$,
\end{center}
where \texttt{sm\_rows} is the number of rows in the scalar multiplication circuit.